#!/usr/bin/env bash

SUITE=${1-bounding_tests}
TEST=${2-p_wx_wy_q_wz_rx_r_rz_ry}
BOUND="-c preemption -b 1"
VERBOSITY=-v9

cd $(dirname $0)
CONCUERROR=../concuerror
CDIR=$(dirname $CONCUERROR)
make -j dev -C $CDIR
$CONCUERROR -ki --print_depth 22 --graph $CDIR/g.dot --show_races $BOUND $VERBOSITY -f suites/$SUITE/src/$TEST.erl -m $TEST
dot -Tsvg -o $CDIR/g.svg $CDIR/g.dot
